{
  "$id": "https://raw.githubusercontent.com/cyentific-rni/cacao-json-schemas/cacao-v2.0-csd03/schemas/authentication-information/private-key.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "private-key",
  "description": "This type defines the private-key authentication information object and is used by agents and targets when performing cryptographic authentication. This object inherits all of the authentication information common properties (see section 6.1). In addition to the inherited properties, this section defines four additional specific properties that are valid for this type. If the kms and kms_key_identifier properties are used the username and private_key properties MUST NOT be populated.",
  "allOf": [
    {
      "$ref": "authentication-information.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The value of this property MUST be 'private-key'.",
          "enum": [
            "private-key"
          ]
        },
        "username": {
          "type": "string",
          "description": "The username to access this agent."
        },
        "private_key": {
          "type": "string",
          "description": "The private key associated with the username to access this agent. This value SHOULD be passed in via a variable."
        },
        "kms": {
          "type": "boolean",
          "description": "If this property is true the key material associated with this authentication information is stored in a key management store and the kms_key_identifier property contains the identifier used to look up the key material associated with the kms_key_identifier. \n\nIf this property is set to 'true' then the value of the kms_key_identifier property MUST be defined and the value of the private_key property MUST be ignored."
        },
        "kms_key_identifier": {
          "type": "string",
          "description": "This property contains the key identifier for the authentication information value stored in a key management service (KMS) used by the orchestration system executing the playbook. \n\nThe specific KMS used by the orchestration system is out of scope of this specification. \n\nIf this property is defined then the kms property MUST be set to 'true'."
        }
      }
    }
  ],
  "unevaluatedProperties": false
}
