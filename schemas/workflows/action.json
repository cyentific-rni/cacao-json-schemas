{
  "$id": "https://raw.githubusercontent.com/cyentific-rni/cacao-json-schemas/cacao-v2.0-csd01/schemas/workflows/action.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "action",
  "description": "The Action Step workflow step contains the actual commands to be executed on one or more agents. These commands are intended to be processed sequentially. In addition to the inherited properties, this section defines five more specific properties that are valid for this type.",
  "allOf": [
    {
      "$ref": "workflow-step.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The value of this property MUST be 'action'.",
          "enum": [
            "action"
          ]
        },
        "commands": {
          "type": "array",
          "description": "A list of commands that are to be executed as part of this step. If more than one command is listed, the commands MUST be processed in the order in which they are listed (see section 5). All commands in a given step MUST be applicable to all the agents and all the targets defined in that step.",
          "items": {
            "$ref": "../commands/command-data.json"
          },
          "minItems": 1
        },
        "agent": {
          "$ref": "../data-types/identifier.json",
          "description": "An agent ID reference that MUST execute the commands defined in this step. \n\nEach ID MUST reference a CACAO 'agent-target' object (see section 6). This list MUST have at least one identifier."
        },
        "targets": {
          "type": "array",
          "description": "A list of target ID references that are affected by the commands defined in this step that are executed by the agent. \n\nEach ID MUST reference a CACAO 'agent-target' object (see section 6). This list MUST have at least one identifier.",
          "items": {
            "$ref": "../data-types/identifier.json"
          },
          "minItems": 1
        },
        "in_args": {
          "type": "array",
          "description": "The list of variable names from the local 'step_variables' dictionary (see section 4.1) or passed into this step from the global 'playbook_variables' dictionary (see section 3.1) that are used in either an agent or one of the target(s) associated with this step. See section 9.16 for more information about variables.",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "out_args": {
          "type": "array",
          "description": "The optional list of variable names from the local 'step_variables' dictionary (see section 4.1) or global 'playbook_variables' dictionary (see section 3.1) that are to be returned from this step after execution of the commands by the agent(s) and stored in the same variable dictionary. See section 9.16 for more information about variables.",
          "items": {
            "type": "string"
          },
          "minItems": 1
        }
      }
    }
  ],
  "required": [
    "commands",
    "agent"
  ],
  "unevaluatedProperties": false
}