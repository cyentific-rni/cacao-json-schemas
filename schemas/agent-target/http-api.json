{
  "$id": "https://raw.githubusercontent.com/cyentific-rni/cacao-json-schemas/cacao-v2.0-csd01/schemas/agent-target/http-api.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "http-api",
  "description": "This type defines an HTTP API object and is used for commands that need to be processed or executed by an HTTP API. In addition to the inherited properties, this section defines six additional specific properties that are valid for this type. In addition to the inherited properties, this section defines seven additional specific properties that are valid for this type.",
  "type": "object",
  "allOf": [
    {
      "$ref": "agent-target.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The value of this property MUST be 'http-api'.",
          "enum": [
            "http-api"
          ]
        },
        "http_url": {
          "type": "string",
          "description": "A full URL of the HTTP API service that should be called."
        },
        "http_auth_type": {
          "type": "string",
          "description": "The authentication type required to access this HTTP API (e.g., 'basic', 'oauth2', etc.)"
        },
        "user_id": {
          "type": "string",
          "description": "The user_id property used in HTTP Basic authentication as defined by [RFC7617]."
        },
        "password": {
          "type": "string",
          "description": "The password property used in HTTP Basic authentication as defined by [RFC7617]."
        },
        "token": {
          "type": "string",
          "description": "The bearer token used in HTTP Bearer Token authentication as defined by [RFC6750]."
        },
        "oauth_header": {
          "type": "string",
          "description": "The OAuth header used in OAuth authentication as defined in section 3.5.1 of [RFC5849]."
        },
        "category": {
          "type": "array",
          "description": "One or more identified categories of security infrastructure types that this agent represents (see section 6.11.1). The value for this property SHOULD come from the 'security-category-type-ov' vocabulary.",
          "items": {
            "$ref": "#/$defs/security-category-type-ov"
          },
          "minItems": 1
        }
      }
    }
  ],
  "required": [
    "http_url"
  ],
  "unevaluatedProperties": false,
  "$defs": {
    "security-category-type-ov": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "string",
          "enum": [
            "aaa",
            "analytics",
            "caldera",
            "content-gateway",
            "desktop",
            "endpoint",
            "firewall",
            "handset",
            "ids",
            "ips",
            "kali",
            "manx",
            "orchestrator",
            "os-linux",
            "os-mac",
            "os-windows",
            "redcanary-atomicred",
            "ragdoll",
            "router",
            "sandcat",
            "server",
            "siem",
            "switch",
            "ticketing",
            "tip",
            "wireless"
          ]
        }
      ]
    }
  }
}