{
  "$id": "https://raw.githubusercontent.com/cyentific-rni/cacao-json-schemas/cacao-v2.0-csd01/schemas/agent-target/http-api.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "http-api",
  "description": "This type defines an HTTP API object and is used for commands that need to be processed or executed by an HTTP API. In addition to the inherited properties, this section defines six additional specific properties that are valid for this type. In addition to the inherited properties, this section defines seven additional specific properties that are valid for this type.",
  "type": "object",
  "allOf": [
    {
      "$ref": "agent-target.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The value of this property MUST be 'http-api'.",
          "enum": [
            "http-api"
          ]
        },
        "http_url": {
          "type": "string",
          "description": "A full URL of the HTTP API service that should be called."
        },
        "credentials": {
          "$ref": "../data-types/identifier.json",
          "description": "This property contains an ID reference to a CACAO 'authentication-credentials' object that is stored at the playbook level in the authentication_credentials_definitions property. The ID MUST reference a CACAO 'authentication-credentials' object (see section 6)."
        },
        "category": {
          "type": "array",
          "description": "One or more identified categories of security infrastructure types that this agent represents (see section 6.11.1). The value for this property SHOULD come from the 'security-category-type-ov' vocabulary.",
          "items": {
            "$ref": "#/$defs/security-category-type-ov"
          },
          "minItems": 1
        }
      }
    }
  ],
  "required": [
    "http_url"
  ],
  "unevaluatedProperties": false,
  "$defs": {
    "security-category-type-ov": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "string",
          "enum": [
            "aaa",
            "analytics",
            "caldera",
            "content-gateway",
            "desktop",
            "endpoint",
            "firewall",
            "handset",
            "ids",
            "ips",
            "kali",
            "manx",
            "orchestrator",
            "os-linux",
            "os-mac",
            "os-windows",
            "redcanary-atomicred",
            "ragdoll",
            "router",
            "sandcat",
            "server",
            "siem",
            "switch",
            "ticketing",
            "tip",
            "wireless"
          ]
        }
      ]
    }
  }
}