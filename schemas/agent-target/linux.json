{
  "$id": "https://raw.githubusercontent.com/cyentific-rni/cacao-json-schemas/cacao-v2.0-csd01/schemas/agent-target/linux.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "linux",
  "description": "This type defines a Linux system object and is used for commands that need to be processed or executed by a Linux system. In addition to the inherited properties, this section defines five additional specific properties that are valid for this type.",
  "type": "object",
  "allOf": [
    {
      "$ref": "agent-target.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The value of this property MUST be 'linux'.",
          "enum": [
            "linux"
          ]
        },
        "address": {
          "type": "object",
          "unevaluatedProperties": false,
          "patternProperties": {
            "^url": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "[(http(s)?):/(www.)?a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_+.~#?&//=]*)"
              }
            },
            "^l2mac": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "^[a-fA-F0-9]{2}(:[a-fA-F0-9]{2}){5}$"
              }
            },
            "^ipv4": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "(\\b25[0-5]|\\b2[0-4][0-9]|\\b[01]?[0-9][0-9]?)(\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$"
              }
            },
            "^ipv6": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$"
              }
            },
            "^vlan": {
              "type": "array",
              "items": {
                "type":"number",
                "minimum": 0,
                "maximum": 4095
              }
            }
          },
          "description": "The key for each entry in the dictionary MUST be a string that uniquely identifies the address type. The key MUST be one of 'ipv4', 'ipv6', 'l2mac', 'vlan', or 'url'."
        },
        "port": {
          "type": "string",
          "description": "The TCP port number for the Linux system. The default value is 22 based on standard port number services [PortNumbers]."
        },
        "username": {
          "type": "string",
          "description": "The username to access this system."
        },
        "password": {
          "type": "string",
          "description": "The password associated with the username to access this system. This value will most often be passed in via a variable."
        },
        "private_key": {
          "type": "string",
          "description": "The private key associated with the username to access this system. This value will most often be passed in via a variable."
        },
        "category": {
          "type": "array",
          "description": "One or more identified categories of security infrastructure types that this agent represents (see section 6.11.1). The value for this property SHOULD come from the 'security-category-type-ov' vocabulary.",
          "items": {
            "type": "string"
          },
          "minItems": 1
        }       
      }
    }
  ],
  "required": [
    "address"
  ],
  "unevaluatedProperties": false
}