{
  "$id": "https://raw.githubusercontent.com/cyentific-rni/cacao-json-schemas/cacao-v2.0-csd01/schemas/agent-target/agent-target.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "agent-target",
  "description": "In a CACAO playbook, agents are the entities that execute commands (see section 5) on or against targets. Agents are stored in a dictionary where the ID is the key and the value is an 'agent-target' object (see section 9.1). Targets are stored in a dictionary where the ID is the key and the value is an 'agent-target' object (see section 9.1). Common properties for agents and targets are defined in section 6.1. \n\nAgents can involve either manual or automated processing. For example, an individual may process a command manually, while a firewall may process a command automatically. An agent type vocabulary is defined in section 6.2, and each agent type is further defined in the rest of the sections. Types include security infrastructure such as firewalls, routers, and threat intelligence platforms, as well as specific network addressable agents like URLs and IPv4/IPv6/MAC addresses. \n\nAgents can use and refer to variables just like other parts of the playbook. For any agent property value, the producer may define a variable substitution such that the actual property value is determined at runtime based on the variable assigned to the agent. In Example 6.1,an agent is referenced within a workflow step, but the agent's actual values are based on variables (e.g., name, email, phone, location) instead of being hard-coded by the agent itself.",
  "type": "object",
  "properties": {
    "type": {
      "$ref": "#/$defs/agent-target-type-ov",
      "description": "The type of object being used. The value of this property SHOULD come from the 'agent-target-type-ov' vocabulary."
    },
    "name": {
      "type": "string",
      "description": "The name that represents this object that is meant to be displayed in a user interface or captured in a log message. This property MUST be populated."
    },
    "description": {
      "type": "string",
      "description": "More details, context, and possibly an explanation about this object. This property SHOULD be populated."
    },
    "location": {
      "$ref": "../data-types/civic-location.json",
      "description": "Physical address information for this object."
    },
    "agent_extensions": {
      "minProperties": 1,
      "type": "object",
      "unevaluatedProperties": false,
      "patternProperties": {
        "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
          "type": "object"
        }
      },
      "description": "This property defines the extensions that are in use on this object. \n\nThe key for each entry in the dictionary MUST be an 'identifier' that uniquely identifies the extension (see section 9.10 for more information on identifiers). The value for each key is a JSON object that can contain the structure as defined in the extension definition's schema property."
    }
  },
  "required": [
    "type",
    "name"
  ],
  "$defs": {
    "agent-target-type-ov": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "string",
          "enum": [
            "group",
            "individual",
            "location",
            "organization",
            "sector",
            "http-api",
            "linux",
            "net-address",
            "security-category",
            "ssh"
          ]
        }
      ]
    }
  }
}